# PA Report for 2-3 Build

### 解题构思

- 最初只想到使用链表存储节点，每个节点维护其父亲，紧邻哥哥，紧邻弟弟，长子，幼子五个地址，以及高度，最大弟弟高度（含自己），子树规模。
- 初始化过程为了节省栈空间，在全局变量上自己模拟一个栈来实现初始化过程，可以将高度，最大弟弟高度和子树规模共同初始化节省时间。
- 之所以维护最大弟弟高度就是为了便于更新维护高度。
- 子树规模的更新相对简单，一直循环遍历节点的所有祖先进行更新即可。
- 用存储空间换取计算复杂度的优化。

### 实现方法

这段代码实现了二叉树的动态子树操作，包括子树删除、添加以及对任意子树规模和高度进行查询的功能。以下是对主要部分的详细分析：

1. **数据结构定义：**

   - `TreeNode` 结构体定义了树的节点，包括子树规模(`subtreenum`)、高度(`height`)、最大弟弟高度(`youngheight`)等信息，以及指向父节点、兄弟节点和长幼子节点的指针，用于更新维护。
   - `Stack` 结构体表示栈，用于模拟系统栈进程，其中包括固定大小的数组存储节点指针、栈顶索引等信息。可以执行栈的各种操作。
2. **更新高度函数 (`Updateheight`)：**

   - 从给定节点开始，递归更新节点的高度以及最大弟弟的高度。
   - 如果节点没有弟弟，则最大弟弟高度为自身的高度；否则，最大弟弟的高度为自身高度和最近的弟弟的最大弟弟高度中的较大值。
   - 如果进行至长子节点，则更新父节点高度再从父节点开始更新。
   - 过程中发现某处最大弟弟高度前后不变则可以停止进程。
3. **插入子树函数 (`InsertAtPosition`)：**

   - 在指定位置插入一棵子树，根据插入位置更新父节点的子树规模和调用 `Updateheight` 更新高度。
4. **删除子树函数 (`DeleteAtPosition`)：**

   - 删除指定子树，根据删除位置更新父节点的子树规模和调用 `Updateheight` 更新高度。
5. **查找位置函数 (`FindLocation`)：**

   - 通过读取输入，找到指定位置的节点，用于后续的插入和删除操作。
   - 过程中注意检查非法路径以及要回收多余的输入。
6. **主函数 (`main`)：**

   - 通过输入初始化树节点的地址数据。
   - 使用人工栈模拟系统栈进程，初始化子树规模与高度信息。
   - 根据输入的命令执行相应的操作，包括插入、删除和查询操作。
7. **时间复杂度分析：**

   - 插入和删除操作的时间复杂度取决于节点的深度，最坏情况下为树的高度，即 O(h)。
   - 查询操作的时间复杂度为 O(1)。
8. **空间复杂度分析：**

   - 空间复杂度主要取决于树的节点数量，为 O(n)，其中 n 为节点数。
   - 栈的空间复杂度为 O(h)，其中 h 为树的高度。

### 调试与微调&问题解决

- 最开始忘记了在出现非法路径时需要回收多余输入，将多余输入回收至垃圾桶后解决。
- 各种边界情况分析，如插入和删除位置是否在最前或最后，空指针判定等等情况，发现后特殊判定处理解决。
- 最开始没有模拟栈，而是用递归原始方法完成高度，最大弟弟高度以及子树规模的初始化，导致栈溢出，人工构造栈结构进行模拟后得到解决。

### 时间和空间复杂度估算

> 空间复杂度
>
>> 一个大小为n的栈
>> 一个大小为n的节点数组
>> 其他的原始数据等（相比可忽略不计）
>>

***综上，空间复杂度大约为O(n)***

> 时间复杂度
>
>> 初始化过程中，每个队列中的元素都入栈出栈各一次，复杂度为O(n)
>> 单个操作过程中复杂度为O(h),h为子树高度
>>

***综上，空间复杂度大约为O(n+mh)***
